<!doctype html><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Enhanced Repository File Viewer</title>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><style>:root{--bg-color:#282c34;--sidebar-bg:#21252b;--text-color:#abb2bf;--border-color:#3e4451;--hover-bg:#2c313c;--accent-color:#61afef;--file-size-color:#8b929e;--button-bg:#3a3f4b;--button-hover:#4a5060;--search-bg:#2c313c;--search-border:#3e4451;--success-color:#98c379;--warning-color:#e5c07b;--error-color:#e06c75}*{transition:background-color .2s ease,color .2s ease,transform .2s ease}body{font-family:segoe ui,Tahoma,Geneva,Verdana,sans-serif;background-color:var(--bg-color);color:var(--text-color);margin:0;display:flex;flex-direction:column;height:100vh;overflow:hidden}.search-header{background-color:var(--sidebar-bg);border-bottom:1px solid var(--border-color);padding:15px 20px;position:sticky;top:0;z-index:100;display:flex;align-items:center;gap:15px}.sidebar-toggle{background:var(--button-bg);border:1px solid var(--border-color);color:var(--text-color);padding:8px 12px;border-radius:5px;cursor:pointer;z-index:101;transition:all .2s ease;display:flex;align-items:center;gap:5px;font-size:14px;flex-shrink:0}.sidebar-toggle:hover{background:var(--button-hover)}.theme-toggle{background:var(--button-bg);border:1px solid var(--border-color);color:var(--text-color);padding:8px 12px;border-radius:5px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:5px;font-size:14px;flex-shrink:0}.theme-toggle:hover{background:var(--button-hover)}.search-container{flex:1;position:relative;width:100%}.search-help{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:0 0;border:none;color:var(--file-size-color);cursor:pointer;font-size:16px}.search-help:focus{outline:none}.search-help-panel{position:absolute;left:0;right:0;top:calc(100% + 8px);background:var(--sidebar-bg);border:1px solid var(--border-color);color:var(--text-color);padding:10px;border-radius:8px;font-size:13px;display:none;z-index:200;box-shadow:0 6px 18px rgba(0,0,0,.3)}.search-help-panel.show{display:block}.search-help-panel b{color:var(--accent-color)}.search-box{width:100%;padding:12px 20px 12px 45px;background-color:var(--search-bg);border:1px solid var(--search-border);border-radius:8px;color:var(--text-color);font-size:16px;outline:none;transition:border-color .2s,box-shadow .2s}.search-box:focus{border-color:var(--accent-color);box-shadow:0 0 0 3px rgba(97,175,239,.2)}.search-box::placeholder{color:var(--file-size-color)}.search-icon{position:absolute;left:15px;top:50%;transform:translateY(-50%);color:var(--file-size-color);pointer-events:none}.search-filters{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}.filter-chip{background:var(--button-bg);border:1px solid var(--border-color);padding:4px 10px;border-radius:15px;font-size:12px;display:flex;align-items:center;gap:5px;cursor:pointer;transition:all .2s ease}.filter-chip:hover{background:var(--button-hover)}.filter-chip.active{background:var(--accent-color);color:#fff}.filter-chip .remove{cursor:pointer;font-weight:700}.main-container{display:flex;flex:1;overflow:hidden}.sidebar{width:400px;background-color:var(--sidebar-bg);border-right:1px solid var(--border-color);display:flex;flex-direction:column;transition:transform .3s ease,width .3s ease;flex-shrink:0;overflow:hidden}.sidebar.collapsed{width:0;transform:translateX(-100%)}.search-results-info{padding:8px 15px;font-size:12px;color:var(--file-size-color);border-bottom:1px solid var(--border-color);background-color:var(--hover-bg)}.breadcrumbs{padding:10px 15px;border-bottom:1px solid var(--border-color);font-size:14px;display:flex;align-items:center;gap:10px}.breadcrumbs span{cursor:pointer;color:var(--accent-color)}.breadcrumbs span:hover{text-decoration:underline}.back-button{background:var(--button-bg);border:1px solid var(--border-color);color:var(--text-color);padding:4px 8px;border-radius:4px;cursor:pointer;font-size:16px;transition:all .2s ease;display:flex;align-items:center;justify-content:center;width:24px;height:24px;flex-shrink:0}.back-button:hover{background:var(--button-hover);transform:translateY(-1px)}.back-button:active{transform:translateY(0)}.back-button:disabled{opacity:.5;cursor:not-allowed}.back-button:disabled:hover{background:var(--button-bg);transform:none}.virtual-scroll-container{flex:1;overflow-y:auto;position:relative}.virtual-scroll-content{position:absolute;top:0;left:0;right:0}.file-list{list-style:none;padding:0;margin:0}.file-list li{padding:8px 15px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:relative;height:40px;box-sizing:border-box}.file-list li:hover{background-color:var(--hover-bg)}.file-list li.selected{background-color:var(--hover-bg);border-left:3px solid var(--accent-color)}.file-list li.search-result{background-color:var(--hover-bg);border-bottom:1px solid var(--border-color)}.file-list li.search-result:hover{background-color:#353b45}.file-list .file-info{display:flex;align-items:center;flex:1;min-width:0;overflow:hidden}.file-list .icon{margin-right:10px;font-size:18px;flex-shrink:0}.file-list .file-name{overflow:hidden;text-overflow:ellipsis}.file-list .file-path{font-size:11px;color:var(--file-size-color);margin-top:2px}.file-list .file-size{color:var(--file-size-color);font-size:12px;margin-left:10px;flex-shrink:0;font-family:consolas,monaco,monospace}.highlight{background-color:rgba(97,175,239,.3);padding:1px 2px;border-radius:2px}.content-viewer{flex-grow:1;padding:20px;overflow-y:auto;overflow-x:hidden;position:relative}.content-viewer pre{margin:0;background-color:initial!important;white-space:pre;overflow-x:auto;position:relative;padding:0}.content-viewer img{max-width:100%;height:auto}.content-viewer .markdown-content{line-height:1.6}.content-viewer .markdown-content h1,.content-viewer .markdown-content h2,.content-viewer .markdown-content h3{border-bottom:1px solid var(--border-color);padding-bottom:.3em}.content-viewer .markdown-content a{color:var(--accent-color)}.content-viewer .markdown-content code{background-color:var(--hover-bg);padding:.2em .4em;border-radius:3px;font-size:85%}.content-viewer .markdown-content table{display:block;overflow-x:auto;white-space:nowrap;border-collapse:collapse;width:100%}.content-viewer .markdown-content th,.content-viewer .markdown-content td{padding:8px 12px;border:1px solid var(--border-color);text-align:left}.content-viewer .markdown-content th{background-color:var(--hover-bg)}.skeleton{background:linear-gradient(90deg,var(--hover-bg) 25%,var(--border-color) 50%,var(--hover-bg) 75%);background-size:200% 100%;animation:loading 1.5s infinite;border-radius:4px}@keyframes loading{0%{background-position:200% 0}100%{background-position:-200% 0}}.skeleton-text{height:16px;margin:8px 0}.skeleton-title{height:24px;width:60%;margin:16px 0}.welcome-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center;padding:20px;max-width:100%;box-sizing:border-box}.shortcuts-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;width:100%;max-width:600px;margin-top:10px}.shortcut-card{background:var(--sidebar-bg);border:1px solid var(--border-color);border-radius:8px;padding:20px;transition:all .3s ease}.shortcut-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.3);border-color:var(--accent-color)}.shortcut-key{display:inline-block;background:var(--button-bg);border:1px solid var(--border-color);border-radius:4px;padding:3px 6px;font-family:consolas,monaco,monospace;font-weight:700;margin:0 3px;box-shadow:0 2px 4px rgba(0,0,0,.2);font-size:.85em}.shortcut-description{margin-top:8px;color:var(--text-color);font-size:.9em}.file-header{background-color:var(--sidebar-bg);padding:15px 20px;margin:-20px -20px 20px;border-bottom:1px solid var(--border-color);display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px;position:sticky;top:0;z-index:10}.file-header .file-title{display:flex;align-items:center;font-size:18px;font-weight:500;flex:1;min-width:0}.file-header .file-title .icon{margin-right:10px;font-size:24px;flex-shrink:0}.file-header .file-meta{display:flex;align-items:center;gap:20px;color:var(--file-size-color);font-size:14px;flex-shrink:0}.file-header .file-actions{display:flex;gap:10px;flex-shrink:0}.file-header .file-actions button{background-color:var(--button-bg);color:var(--text-color);border:1px solid var(--border-color);padding:6px 12px;border-radius:5px;cursor:pointer;font-size:14px;display:flex;align-items:center;gap:5px;transition:all .2s ease}.file-header .file-actions button:hover{background-color:var(--button-hover);transform:translateY(-1px)}.file-header .file-actions button:active{transform:translateY(0)}.copy-button{position:absolute;top:10px;right:10px;background:var(--button-bg);border:1px solid var(--border-color);color:var(--text-color);padding:8px 12px;border-radius:5px;cursor:pointer;font-size:14px;opacity:0;transition:opacity .2s ease;z-index:5}.line-numbers-wrapper:hover .copy-button{opacity:1}.copy-button:hover{background:var(--button-hover)}.copy-button.copied{background:var(--success-color);color:#fff}.line-numbers-wrapper{display:flex;background-color:var(--sidebar-bg);border:1px solid var(--border-color);border-radius:5px;overflow:auto;margin:10px 0;max-height:calc(100vh - 200px);position:relative}.line-numbers{width:60px;padding:15px 10px;background:var(--sidebar-bg);border-right:1px solid var(--border-color);text-align:right;color:var(--file-size-color);font-family:consolas,monaco,monospace;font-size:14px;line-height:1.5;user-select:none;flex-shrink:0;position:sticky;left:0}.code-content{flex:1;padding:15px;font-family:consolas,monaco,monospace;font-size:14px;line-height:1.5;white-space:pre;overflow:visible;min-width:0}.code-content pre{margin:0;padding:0;background:0 0!important;overflow:visible}.code-content code{font-family:consolas,monaco,monospace;font-size:14px;line-height:1.5;white-space:pre;display:block}.wrap-toggle{position:fixed;bottom:20px;right:20px;background:var(--button-bg);border:1px solid var(--border-color);color:var(--text-color);padding:10px 15px;border-radius:25px;cursor:pointer;font-size:14px;display:flex;align-items:center;gap:8px;box-shadow:0 2px 8px rgba(0,0,0,.3);transition:all .2s ease;z-index:100}.wrap-toggle:hover{background:var(--button-hover);transform:translateY(-2px)}.wrap-toggle.active{background:var(--accent-color);color:#fff}.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%)translateY(100px);background:var(--sidebar-bg);border:1px solid var(--border-color);padding:12px 20px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.3);opacity:0;transition:all .3s ease;z-index:1000}.toast.show{transform:translateX(-50%)translateY(0);opacity:1}.toast.success{border-color:var(--success-color);background:rgba(152,195,121,.1);color:var(--success-color)}.toast.error{border-color:var(--error-color);background:rgba(224,108,117,.1);color:var(--error-color)}.adv-help-overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:1200}.adv-help-modal{background:var(--sidebar-bg);border:1px solid var(--border-color);color:var(--text-color);padding:12px 8px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.5);max-width:90%;width:auto;font-size:2em;line-height:1.3;text-align:left}@media(max-width:480px){.adv-help-modal{font-size:1.6em;padding:10px 6px}}.error-boundary{padding:20px;background:var(--error-color);color:#fff;border-radius:8px;margin:20px}.error-boundary h3{margin-top:0}.error-boundary pre{background:rgba(0,0,0,.2);padding:10px;border-radius:4px;overflow-x:auto}:focus-visible{outline:2px solid var(--accent-color);outline-offset:2px}@media(max-width:768px){.sidebar{position:absolute;z-index:50;height:100%}.sidebar.collapsed{transform:translateX(-100%)}.file-header{flex-direction:column;align-items:flex-start}.file-header .file-meta{flex-wrap:wrap;gap:10px}.shortcuts-grid{grid-template-columns:repeat(2,1fr);gap:15px;max-width:400px}.shortcut-card{padding:15px}.line-numbers{width:40px;padding:10px 5px}.search-filters{display:none}}body.light-theme{--bg-color:#ffffff;--sidebar-bg:#f6f8fa;--text-color:#24292e;--border-color:#d1d5da;--hover-bg:#f3f4f6;--accent-color:#0366d6;--file-size-color:#6a737d;--button-bg:#fafbfc;--button-hover:#e1e4e8;--search-bg:#fafbfc;--search-border:#d1d5da}body.solarized-theme{--bg-color:#002b36;--sidebar-bg:#073642;--text-color:#839496;--border-color:#586e75;--hover-bg:#073642;--accent-color:#268bd2;--file-size-color:#657b83;--button-bg:#073642;--button-hover:#586e75;--search-bg:#073642;--search-border:#586e75}</style><header class=search-header><button class=sidebar-toggle id=sidebar-toggle title="Toggle Sidebar">
<i class="fas fa-bars"></i>
<span>Files</span></button><div class=search-container><i class="fas fa-search search-icon"></i>
<input class=search-box id=search-box placeholder="🔍 Search files... (use ext:, size:, path:, type: filters)" autocomplete=off><div class=search-filters id=search-filters></div></div><button class=theme-toggle id=theme-toggle title="Toggle Theme">
<i class="fas fa-moon"></i></button></header><div class=main-container><aside class=sidebar id=sidebar><nav class=breadcrumbs id=breadcrumbs><span>root</span></nav><div class=search-results-info id=search-results-info style=display:none></div><div class=virtual-scroll-container id=virtual-scroll-container><div class=virtual-scroll-content id=virtual-scroll-content><ul class=file-list id=file-list><li class=loading><div class="skeleton skeleton-text"></div><div class="skeleton skeleton-text"></div><div class="skeleton skeleton-text" style=width:70%></div></ul></div></div></aside><main class=content-viewer id=content-viewer></main></div><div id=adv-help-modal class=adv-help-overlay aria-hidden=true><div class=adv-help-modal role=dialog id=adv-help-content><div><b>Advanced search examples</b></div><div style=margin-top:8px><div><b>ext:</b> js, py, md — e.g. <code>ext:js</code></div><div><b>size:</b> comparison (>, >=, <, <=, =) with k/m/g — e.g. <code>size:>10k</code></div><div><b>path:</b> match anywhere in path — e.g. <code>path:src/components</code></div><div><b>type:</b> file or folder — e.g. <code>type:folder</code></div></div><div style=margin-top:10px;color:var(--file-size-color);font-size:.6em>Press <kbd>h</kbd> again or click/press any key to dismiss.</div></div></div><button class=wrap-toggle id=wrap-toggle title="Toggle Word Wrap" style=display:none>
<i class="fas fa-text-width"></i>
<span>Wrap</span></button><div class=toast id=toast></div><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js></script><script>document.addEventListener("DOMContentLoaded",()=>{const t={fullFileTree:[],currentPath:[],allFiles:[],searchResults:[],currentTheme:localStorage.getItem("theme")||"dark",selectedIndex:-1,wordWrap:!1,currentFileContent:"",searchFilters:{},virtualScroll:{itemHeight:40,visibleItems:0,startIndex:0,scrollTop:0},advHelpOpenTime:0},e={fileListEl:document.getElementById("file-list"),breadcrumbsEl:document.getElementById("breadcrumbs"),contentViewerEl:document.getElementById("content-viewer"),searchBox:document.getElementById("search-box"),searchResultsInfo:document.getElementById("search-results-info"),searchFiltersEl:document.getElementById("search-filters"),sidebarToggle:document.getElementById("sidebar-toggle"),sidebar:document.getElementById("sidebar"),wrapToggle:document.getElementById("wrap-toggle"),toast:document.getElementById("toast"),themeToggle:document.getElementById("theme-toggle"),virtualScrollContainer:document.getElementById("virtual-scroll-container"),virtualScrollContent:document.getElementById("virtual-scroll-content"),advHelpModal:document.getElementById("adv-help-modal")},s={pointer:null,key:null},M={js:"🟨",jsx:"🟨",ts:"🔷",tsx:"🔷",py:"🐍",java:"☕",cpp:"🔷",c:"🔹",cs:"🔷",php:"🐘",rb:"💎",go:"🐹",rs:"🦀",swift:"🍎",kt:"🎯",dart:"🎯",scala:"🔴",lua:"🌙",r:"📊",m:"🔷",sh:"⌨️",bash:"⌨️",zsh:"⌨️",ps1:"💙",sql:"🗃️",html:"🌐",htm:"🌐",css:"🎨",scss:"🎨",sass:"🎨",less:"🎨",vue:"💚",svelte:"🧡",json:"📋",xml:"📄",yaml:"📄",yml:"📄",toml:"📄",ini:"⚙️",conf:"⚙️",env:"🔐",lock:"🔒",md:"📝",txt:"📄",pdf:"📕",doc:"📘",docx:"📘",png:"🖼️",jpg:"🖼️",jpeg:"🖼️",gif:"🖼️",svg:"🎨",webp:"🖼️",ico:"🖼️",bmp:"🖼️",mp4:"🎬",avi:"🎬",mov:"🎬",wmv:"🎬",webm:"🎬",mkv:"🎬",flv:"🎬",mp3:"🎵",wav:"🎵",flac:"🎵",aac:"🎵",ogg:"🎵",m4a:"🎵",zip:"📦",rar:"📦",tar:"📦",gz:"📦","7z":"📦",exe:"⚙️",dll:"⚙️",so:"⚙️",app:"📱",apk:"📱",ipa:"📱"},r={dark:{icon:"fas fa-moon",class:""},light:{icon:"fas fa-sun",class:"light-theme"},solarized:{icon:"fas fa-sun",class:"solarized-theme"}};class D{constructor(){this.setupGlobalHandlers()}setupGlobalHandlers(){window.addEventListener("error",this.handleError.bind(this)),window.addEventListener("unhandledrejection",this.handlePromiseRejection.bind(this))}handleError(e){console.error("Global error:",e.error),this.showErrorToast("An unexpected error occurred"),this.renderErrorScreen(e.error),e.preventDefault()}handlePromiseRejection(e){console.error("Unhandled promise rejection:",e.reason),this.showErrorToast("Operation failed"),e.preventDefault()}showErrorToast(e){o(e,"error")}renderErrorScreen(t){e.contentViewerEl.innerHTML=`
                        <div class="error-boundary">
                            <h3><i class="fas fa-exclamation-triangle"></i> Something went wrong</h3>
                            <p>${t.message||"An unexpected error occurred"}</p>
                            <details>
                                <summary>Error Details</summary>
                                <pre>${t.stack||"No stack trace available"}</pre>
                            </details>
                            <button onclick="location.reload()" style="margin-top: 10px;">
                                <i class="fas fa-redo"></i> Reload Page
                            </button>
                        </div>
                    `}}class P{constructor(e,t=40){this.container=e,this.itemHeight=t,this.visibleItems=Math.ceil(e.clientHeight/t)+2,this.scrollTop=0,this.startIndex=0,this.items=[],this.setupListeners()}setupListeners(){this.container.addEventListener("scroll",this.handleScroll.bind(this)),window.addEventListener("resize",this.handleResize.bind(this))}handleScroll(){const e=this.container.scrollTop,n=Math.floor(e/this.itemHeight);n!==this.startIndex&&(this.startIndex=n,this.render()),t.virtualScroll.scrollTop=e}handleResize(){this.visibleItems=Math.ceil(this.container.clientHeight/this.itemHeight)+2,this.render()}setItems(e){this.items=e,this.updateContainerHeight(),this.render()}updateContainerHeight(){const t=this.items.length*this.itemHeight;e.virtualScrollContent.style.height=`${t}px`}render(){const t=Math.min(this.startIndex+this.visibleItems,this.items.length),n=this.items.slice(this.startIndex,t);e.fileListEl.innerHTML="",n.forEach((t,n)=>{const o=this.startIndex+n,s=this.createListItem(t,o);s.style.position="absolute",s.style.top=`${o*this.itemHeight}px`,s.style.width="100%",e.fileListEl.appendChild(s)})}createListItem(e,s){const o=document.createElement("li");if(o.dataset.index=s,s===t.selectedIndex&&o.classList.add("selected"),e.type==="folder")e.name===".."?(o.innerHTML=`
                                <div class="file-info">
                                    <span class="icon">📁</span>
                                    <span class="file-name">..</span>
                                </div>
                                <span class="file-size">Parent</span>
                            `,o.onclick=()=>m()):(o.innerHTML=`
                                <div class="file-info">
                                    <span class="icon">📁</span>
                                    <span class="file-name">${e.name}</span>
                                </div>
                            `,o.onclick=()=>n([...t.currentPath,e.name]));else{const t=v(e.name),n=e.size?g(e.size):"",s=e.directory||"";e.isSearchResult&&s?o.innerHTML=`
                                <div class="file-info" style="min-width:0;">
                                    <span class="icon">${t}</span>
                                    <div style="display:flex;flex-direction:column;overflow:hidden;min-width:0;">
                                        <span class="file-path" style="font-size:11px;color:var(--file-size-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${s}</span>
                                        <span class="file-name">${e.name}</span>
                                    </div>
                                </div>
                                <span class="file-size">${n}</span>
                            `:o.innerHTML=`
                                <div class="file-info">
                                    <span class="icon">${t}</span>
                                    <span class="file-name">${e.name}</span>
                                </div>
                                <span class="file-size">${n}</span>
                            `,o.onclick=()=>c(e.path,e.name,e.size)}return o}}class R{constructor(e){this.element=e,this.startX=0,this.startY=0,this.threshold=50,this.setupListeners()}setupListeners(){this.element.addEventListener("touchstart",this.handleStart.bind(this),{passive:!0}),this.element.addEventListener("touchend",this.handleEnd.bind(this),{passive:!0})}handleStart(e){this.startX=e.touches[0].clientX,this.startY=e.touches[0].clientY}handleEnd(e){const n=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY,t=n-this.startX,o=s-this.startY;Math.abs(t)>Math.abs(o)&&Math.abs(t)>this.threshold&&(t>0?this.onSwipeRight():this.onSwipeLeft())}onSwipeRight(){e.sidebar.classList.contains("collapsed")&&e.sidebar.classList.remove("collapsed")}onSwipeLeft(){e.sidebar.classList.contains("collapsed")||e.sidebar.classList.add("collapsed")}}const H=new D;let i,j;function y(){i=new P(e.virtualScrollContainer)}function E(){"ontouchstart"in window&&(j=new R(document.body))}function d(n){const s=r[n];if(!s)return;document.body.classList.remove("light-theme","solarized-theme"),n!=="dark"&&document.body.classList.add(s.class),e.themeToggle.innerHTML=`<i class="${s.icon}"></i>`,t.currentTheme=n,localStorage.setItem("theme",n)}const f={"ext:":(e,t)=>{const n=e.name.split(".").pop().toLowerCase();return t.split(",").includes(n)},"size:":(e,t)=>{const o=t.match(/(>=|<=|>|<|=)(\d+)(k|m|g)?/i);if(!o)return!1;const[,a,r,i]=o,n=e.size||0,c=i?{k:1024,m:1024*1024,g:1024*1024*1024}[i.toLowerCase()]||1:1,s=parseInt(r)*c;switch(a){case">=":return n>=s;case"<=":return n<=s;case">":return n>s;case"<":return n<s;case"=":return n===s;default:return!1}},"path:":(e,t)=>e.path.toLowerCase().includes(t.toLowerCase()),"type:":(e,t)=>e.type===t};function x(e){const n={};let t=e;for(const[o,a]of Object.entries(f)){const i=new RegExp(`${o}([^\\s]+)`,"g");let s;for(;(s=i.exec(e))!==null;)n[o]=s[1],t=t.replace(s[0],"").trim()}return{searchText:t,filters:n}}function O(n){e.searchFiltersEl.innerHTML="",Object.entries(n).forEach(([n,s])=>{const o=document.createElement("div");o.className="filter-chip active",o.innerHTML=`
                        ${n}${s}
                        <span class="remove" data-operator="${n}">×</span>
                    `,o.querySelector(".remove").onclick=e=>{e.stopPropagation(),delete t.searchFilters[n],w()},e.searchFiltersEl.appendChild(o)})}function w(){const n=[];Object.entries(t.searchFilters).forEach(([e,t])=>{n.push(`${e}${t}`)}),t.searchQuery&&n.push(t.searchQuery),e.searchBox.value=n.join(" "),b(e.searchBox.value)}function b(s){if(!s){n(t.currentPath),e.searchResultsInfo.style.display="none",e.searchFiltersEl.innerHTML="",t.searchFilters={};return}const{searchText:o,filters:a}=x(s);t.searchQuery=o,t.searchFilters=a,O(a);const i=[];for(const e of t.allFiles){let n=!0;for(const[t,s]of Object.entries(a))if(!f[t](e,s)){n=!1;break}if(!n)continue;if(o){const t=_(o,e.fullPath);t&&i.push({...e,score:t.score,matches:t.matches})}else i.push(e)}o&&i.sort((e,t)=>t.score-e.score),C(i,o)}function _(e,t){e=e.toLowerCase(),t=t.toLowerCase();let s=0,n=0,o=0,i=0,a=[];for(;s<e.length&&n<t.length;)e[s]===t[n]?(a.push(n),o+=1+i*.5,i++,s++):i=0,n++;return s===e.length?(o+=(t.length-n)*.1,{score:o,matches:a}):null}function I(e,t){if(!t||t.length===0)return e;let n="",s=0;for(const o of t)n+=e.substring(s,o),n+=`<span class="highlight">${e[o]}</span>`,s=o+1;return n+=e.substring(s),n}function o(t,n="success"){e.toast.textContent=t,e.toast.className=`toast ${n}`,setTimeout(()=>e.toast.classList.add("show"),10),setTimeout(()=>{e.toast.classList.remove("show")},3e3)}function v(e){const t=e.split(".").pop().toLowerCase();return M[t]||"📄"}function g(e){if(e===0)return"0 B";const t=1024,s=["B","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,n)).toFixed(1))+" "+s[n]}function p(e,t=""){let n=[];for(const s of e){const o=t?`${t}/${s.name}`:s.name;s.type==="file"?n.push({...s,fullPath:o,directory:t}):s.children&&(n=n.concat(p(s.children,o)))}return n}function C(n,s){if(e.fileListEl.innerHTML="",e.breadcrumbsEl.style.display="none",e.searchResultsInfo.style.display="block",e.searchResultsInfo.textContent=`Found ${n.length} file${n.length!==1?"s":""} matching "${s}"`,t.selectedIndex=n.length>0?0:-1,n.length===0){e.fileListEl.innerHTML='<li class="loading" style="color: var(--file-size-color);">No files found</li>';return}const o=n.map((e,t)=>({...e,type:"file",isSearchResult:!0,originalIndex:t}));i.setItems(o),setTimeout(a,0)}function a(){if(i.render(),t.selectedIndex===-1)return;const n=e.virtualScrollContainer,o=t.virtualScroll.itemHeight,s=t.selectedIndex*o,a=s+o,r=n.scrollTop,c=r+n.clientHeight;s<r?n.scrollTop=s:a>c&&(n.scrollTop=a-n.clientHeight)}async function k(){try{const e=await fetch("./index.json");if(!e.ok)throw new Error("Failed to load index.json");t.fullFileTree=await e.json(),t.allFiles=p(t.fullFileTree),n([])}catch(t){e.fileListEl.innerHTML=`<li class="loading" style="color: var(--error-color);">Error: ${t.message}</li>`,o(`Error loading file tree: ${t.message}`,"error"),console.error(t)}}function A(e){let n={children:t.fullFileTree};for(const s of e){const t=n.children.find(e=>e.name===s&&e.type==="folder");if(!t)return null;n=t}return n}function S(t){let n="";n+=`<span onclick="renderDirectory([])">root</span>`;let s=[];for(const e of t)s.push(e),n+=` / <span onclick="renderDirectory(${JSON.stringify(s)})">${e}</span>`;e.breadcrumbsEl.innerHTML=n}function n(n){t.currentPath=n;const s=A(n);if(!s||!s.children)return;e.fileListEl.innerHTML="",e.breadcrumbsEl.style.display="block",e.searchResultsInfo.style.display="none",e.searchFiltersEl.innerHTML="",S(n),e.virtualScrollContainer.scrollTop=0,t.selectedIndex=-1,n.length===0?(e.contentViewerEl.innerHTML=`
                        <div class="welcome-screen">
                            <div class="shortcuts-grid">
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">↑</span>
                                        <span class="shortcut-key">↓</span>
                                    </div>
                                    <div class="shortcut-description">Navigate file list</div>
                                </div>
                                
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">Enter</span>
                                    </div>
                                    <div class="shortcut-description">Open file/folder</div>
                                </div>
                                
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">←</span>
                                        <span class="shortcut-key">→</span>
                                    </div>
                                    <div class="shortcut-description">Go back/Enter</div>
                                </div>
                                
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">/</span>
                                    </div>
                                    <div class="shortcut-description">Focus search</div>
                                </div>
                                
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">Esc</span>
                                    </div>
                                    <div class="shortcut-description">Clear search</div>
                                </div>

                                <!-- Advanced help keybind card added here (keeps welcome screen consistent) -->
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">h</span>
                                    </div>
                                    <div class="shortcut-description">Advanced search tips</div>
                                </div>
                                
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">T</span>
                                    </div>
                                    <div class="shortcut-description">Toggle theme</div>
                                </div>

                                <!-- Added shortcuts -->
                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">B</span>
                                    </div>
                                    <div class="shortcut-description">Toggle sidebar</div>
                                </div>

                                <div class="shortcut-card">
                                    <div>
                                        <span class="shortcut-key">Ctrl</span>
                                        <span class="shortcut-key">C</span>
                                    </div>
                                    <div class="shortcut-description">Copy file content</div>
                                </div>
                            </div>
                        </div>
                    `,e.wrapToggle.style.display="none"):e.contentViewerEl.innerHTML=`<p>Select a file to preview.</p>`;const o=[];n.length>0&&o.push({type:"folder",name:"..",isBack:!0}),s.children.sort((e,t)=>e.type!==t.type?e.type==="folder"?-1:1:e.name.localeCompare(t.name)),s.children.forEach(e=>{o.push(e)}),i.setItems(o)}function F(e,t){const n=document.createElement("button");n.className="copy-button",n.innerHTML='<i class="fas fa-copy"></i> Copy',n.onclick=async()=>{try{await navigator.clipboard.writeText(t),n.innerHTML='<i class="fas fa-check"></i> Copied!',n.classList.add("copied"),o("Code copied to clipboard"),setTimeout(()=>{n.innerHTML='<i class="fas fa-copy"></i> Copy',n.classList.remove("copied")},2e3)}catch{o("Failed to copy code","error")}},e.appendChild(n)}function T(e,t){const r=e.split(`
`),n=document.createElement("div");n.className="line-numbers-wrapper";const o=document.createElement("div");o.className="line-numbers",o.innerHTML=r.map((e,t)=>t+1).join("<br>");const s=document.createElement("code");s.className=`language-${t}`,s.textContent=e,Prism.languages[t]&&(s.innerHTML=Prism.highlight(e,Prism.languages[t],t));const a=document.createElement("pre");a.appendChild(s);const i=document.createElement("div");return i.className="code-content",i.appendChild(a),n.appendChild(o),n.appendChild(i),n}function z(){t.wordWrap=!t.wordWrap;const n=e.contentViewerEl.querySelector(".code-content code");n&&(t.wordWrap?(n.style.whiteSpace="pre-wrap",n.style.wordBreak="break-word",e.wrapToggle.classList.add("active")):(n.style.whiteSpace="pre",n.style.wordBreak="normal",e.wrapToggle.classList.remove("active")))}async function c(n,s,i){const a=v(s),r=i?g(i):"Unknown size";e.contentViewerEl.innerHTML=`
                    <div class="file-header">
                        <div class="file-title">
                            <span class="icon">${a}</span>
                            <span>${s}</span>
                        </div>
                        <div class="file-meta">
                            <span><i class="fas fa-chart-bar"></i> ${r}</span>
                            <span><i class="fas fa-folder"></i> ${n}</span>
                        </div>
                        <div class="file-actions">
                            <button id="back-btn" onclick="renderDirectory([])">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                            <button id="raw-btn" onclick="viewRaw('${n}')">
                                <i class="fas fa-file"></i> Raw
                            </button>
                            <button id="download-btn" onclick="downloadFile('${n}', '${s}')">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                    <div class="loading">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text" style="width: 80%;"></div>
                    </div>
                `,e.wrapToggle.style.display="flex";try{const r=await fetch(`./${n}`);if(!r.ok)throw new Error(`Could not fetch ${n}`);const a=await r.text();t.currentFileContent=a;const i=s.split(".").pop().toLowerCase();let o=null;if(i==="md")o=document.createElement("div"),o.className="markdown-content",o.innerHTML=marked.parse(a);else if(["png","jpg","jpeg","gif","svg","webp","bmp","ico"].includes(i))o=document.createElement("img"),o.src=`./${n}`,o.alt=s;else if(["mp4","webm","ogg","avi","mov","wmv","mkv","flv"].includes(i))o=document.createElement("video"),o.src=`./${n}`,o.controls=!0,o.style.maxWidth="100%",o.style.height="auto";else if(["mp3","wav","flac","aac","ogg","m4a"].includes(i))o=document.createElement("audio"),o.src=`./${n}`,o.controls=!0,o.style.width="100%",o.style.outline="none";else if(["pdf"].includes(i))o=document.createElement("embed"),o.src=`./${n}`,o.type="application/pdf",o.width="100%",o.height="600px";else{const s=Prism.languages[i]?i:"plaintext",n=T(a,s);if(F(n,a),o=n,t.wordWrap){const t=n.querySelector("code");t&&(t.style.whiteSpace="pre-wrap",t.style.wordBreak="break-word",e.wrapToggle.classList.add("active"))}}const c=e.contentViewerEl.querySelector(".file-header");e.contentViewerEl.innerHTML="",c&&e.contentViewerEl.appendChild(c),o&&e.contentViewerEl.appendChild(o)}catch(t){e.contentViewerEl.innerHTML=`
                        <div class="file-header">
                            <div class="file-title">
                                <span class="icon">${a}</span>
                                <span>${s}</span>
                            </div>
                            <div class="file-meta">
                                <span><i class="fas fa-chart-bar"></i> ${r}</span>
                                <span><i class="fas fa-folder"></i> ${n}</span>
                            </div>
                            <div class="file-actions">
                                <button id="back-btn" onclick="renderDirectory([])">
                                    <i class="fas fa-arrow-left"></i> Back
                                </button>
                            </div>
                        </div>
                        <p style="color: var(--error-color);">Error loading file: ${t.message}</p>
                    `,o(`Error loading file: ${t.message}`,"error"),console.error(t)}}function N(e){window.open(`./${e}`,"_blank")}async function L(e,t){try{const s=await fetch(`./${e}`);if(!s.ok)throw new Error(`Could not fetch ${e}`);const a=await s.blob(),i=window.URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download=t,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(i),document.body.removeChild(n),o(`Downloaded ${t}`)}catch(e){console.error("Download failed:",e),o(`Failed to download ${t}: ${e.message}`,"error")}}e.sidebarToggle.addEventListener("click",()=>{e.sidebar.classList.toggle("collapsed")}),e.wrapToggle.addEventListener("click",z),e.themeToggle.addEventListener("click",()=>{const e=Object.keys(r),n=e.indexOf(t.currentTheme),s=(n+1)%e.length;d(e[s])});let u;e.searchBox.addEventListener("input",e=>{clearTimeout(u),u=setTimeout(()=>{b(e.target.value)},150)});function h(){const n=e.advHelpModal;if(!n)return;if(n.style.display==="flex"){l();return}n.style.display="flex",n.setAttribute("aria-hidden","false"),t.advHelpOpenTime=performance.now(),s.pointer=e=>{l()},s.key=e=>{const n=performance.now();if(n-t.advHelpOpenTime<50)return;l()},document.addEventListener("pointerdown",s.pointer,!0),document.addEventListener("keydown",s.key,!0)}function l(){const t=e.advHelpModal;if(!t)return;t.style.display="none",t.setAttribute("aria-hidden","true"),s.pointer&&(document.removeEventListener("pointerdown",s.pointer,!0),s.pointer=null),s.key&&(document.removeEventListener("keydown",s.key,!0),s.key=null)}e.searchBox.addEventListener("keydown",s=>{s.key==="Escape"&&(e.searchBox.value="",e.searchBox.blur(),n(t.currentPath))}),document.addEventListener("keydown",s=>{const l=i.items,u=document.activeElement===e.searchBox;if(u){if(s.key&&s.key.toLowerCase()==="h"){s.preventDefault(),h();return}if(!l||l.length===0)return;if(["ArrowUp","ArrowDown","Enter"].includes(s.key)){if(s.preventDefault(),s.key==="ArrowUp"){t.selectedIndex=Math.max(0,t.selectedIndex-1),a();return}if(s.key==="ArrowDown"){t.selectedIndex=Math.min(l.length-1,t.selectedIndex+1),a();return}if(s.key==="Enter"){const e=l[t.selectedIndex];e&&(e.isBack?n(t.currentPath.slice(0,-1)):e.type==="folder"?n([...t.currentPath,e.name]):c(e.path,e.name,e.size));return}}return}if(s.target.tagName==="INPUT"||s.target.tagName==="TEXTAREA"){s.key==="Escape"&&s.target.blur();return}if(!l||l.length===0)return;if(s.key&&s.key.toLowerCase()==="h"){s.preventDefault(),h();return}switch(s.key){case"ArrowUp":s.preventDefault(),t.selectedIndex=Math.max(0,t.selectedIndex-1),a();break;case"ArrowDown":s.preventDefault(),t.selectedIndex=Math.min(l.length-1,t.selectedIndex+1),a();break;case"ArrowLeft":s.preventDefault(),n(t.currentPath.length>0?t.currentPath.slice(0,-1):[]);break;case"ArrowRight":case"Enter":if(s.preventDefault(),t.selectedIndex>=0&&l[t.selectedIndex]){const e=l[t.selectedIndex];e.isBack?n(t.currentPath.slice(0,-1)):e.type==="folder"?n([...t.currentPath,e.name]):c(e.path,e.name,e.size)}break;case"/":s.preventDefault(),e.searchBox.focus();break;case"Escape":s.preventDefault(),e.searchBox.value?(e.searchBox.value="",n(t.currentPath)):n([]);break;case"b":case"B":s.preventDefault(),e.sidebar.classList.toggle("collapsed");break;case"t":case"T":s.preventDefault();const i=Object.keys(r),u=i.indexOf(t.currentTheme),h=(u+1)%i.length;d(i[h]);break;case"c":case"C":if(s.ctrlKey||s.metaKey){s.preventDefault();const t=e.contentViewerEl.querySelector(".code-content code");t&&(navigator.clipboard.writeText(t.textContent),o("File content copied to clipboard"))}break}});function m(){t.currentPath.length>0&&n(t.currentPath.slice(0,-1))}window.renderDirectory=n,window.viewRaw=N,window.downloadFile=L,window.goBackOneFolder=m,y(),E(),d(t.currentTheme),k()})</script>